CREATE TABLE users (id INT PRIMARY KEY AUTO_INCREMENT, email VARCHAR(100) NOT NULL UNIQUE, password VARCHAR(64) NOT NULL);
CREATE TABLE patients (id INT PRIMARY KEY AUTO_INCREMENT, personal_id CHAR(14) NOT NULL UNIQUE, name VARCHAR(50) NOT NULL, lastname VARCHAR(50) NOT NULL, birthdate DATE NOT NULL, email VARCHAR(100), phone VARCHAR(11), follow_up BOOLEAN NOT NULL, user_id INT, FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE);
CREATE TABLE consultations (id INT PRIMARY KEY AUTO_INCREMENT, description TEXT NULL, origin TINYINT NOT NULL, service TINYINT NOT NULL, status TINYINT NOT NULL, programed_date DATETIME NULL, registration_date DATETIME NULL, duration INT NULL, patient_id INT NOT NULL, FOREIGN KEY (patient_id) REFERENCES patients(id), details_id INT NULL, FOREIGN KEY (details_id) REFERENCES consultation_details(id));
CREATE TRIGGER create_consultation BEFORE INSERT ON consultations FOR EACH ROW SET NEW.registration_date = NOW();
CREATE TABLE consultation_details (id INT PRIMARY KEY AUTO_INCREMENT, weight TINYINT UNSIGNED NULL, height TINYINT UNSIGNED NULL, temperature TINYINT NULL, systolic_pressure TINYINT UNSIGNED NULL, diastolic_pressure TINYINT UNSIGNED NULL, heart_rate TINYINT UNSIGNED NULL, symptoms TEXT NOT NULL, diagnosis TEXT NOT NULL, treatment TEXT NOT NULL);
